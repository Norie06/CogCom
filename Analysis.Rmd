---

title: "Trustworthiness data analysis"

author: Arina Ljastsenko, Aurelija Spunde, Nora Milena Modla

date: 10/12-2024

output: html_document

---

```{r loading packages}

knitr::opts_chunk$set(echo = TRUE, include = TRUE, message = FALSE, warning = FALSE)  

pacman::p_load(tidyverse,  
               pastecs,  
               car, 
               dplyr, 
               ggplot2, 
               scales,
               lme4,
               lmerTest)

```

```{r loading data}

df <- read.csv("data.csv")

```

```{r NMM Fitting mixed effects model}
#NMM

library(lme4)

# Fit the model
model <- lmer(Score ~ Gaze + Audio + Gender + Age + (1|Participant_ID) + (1|Story), data = df)

# Summary of the model
summary(model)

```

```{r NMM Residual assumptions}

fitted <- fitted(model)
residuals <- resid(model)

res_df <- data.frame(Fitted = fitted, Residuals = residuals)

ggplot(res_df, aes(x = Fitted, y = Residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, color = "red") +
  theme_minimal() +
  labs(title = "Residuals vs. Fitted Values", x = "Fitted Values", y = "Residuals")

#No funnel shape, we're good :) -> homoscedastic data
```

```{r NMM Variance Inflation Factor}

vif(model)

#There is no indication of high multicollinearity (which would be VIF > 5-10 values)
```

```{r NMM Checking for outliers}

# Calculate Cook's distance for each data point
cooks_dist <- cooks.distance(model)

# Plot Cook's distance
plot(cooks_dist, type = "h", main = "Cook's Distance", 
     xlab = "Index", ylab = "Cook's Distance")
abline(h = 1, col = "red")  # Threshold for influential points

print(cooks_dist)

# Calculate leverage
leverage <- hatvalues(model)

# Plot leverage
plot(leverage, type = "h", main = "Leverage", 
     xlab = "Index", ylab = "Leverage")
abline(h = 2 * mean(leverage), col = "red")  # Threshold for high leverage

```


```{r AS}
#AS

library(lme4)

# Fit the model
model <- lmer(Score ~ Gaze + Audio + Gender + Age + (1|Participant_ID) + (1|Story), data = df)

# Summary of the model
summary(model)

```

```{r NMM Residual assumptions}

fitted <- fitted(model)
residuals <- resid(model)

res_df <- data.frame(Fitted = fitted, Residuals = residuals)

ggplot(res_df, aes(x = Fitted, y = Residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, color = "red") +
  theme_minimal() +
  labs(title = "Residuals vs. Fitted Values", x = "Fitted Values", y = "Residuals")

#No funnel shape, we're good :) -> homoscedastic data
```

```{r NMM Checking for outliers}



```


```{r AS}
#AS

ggplot(df, aes(x = Gaze, y = Score, fill = Gaze)) +
  geom_boxplot()+
  labs(x = "Gaze direction",
       y = "Credibility")+
         theme_minimal()

```

```{r AS}
#AS

m1 <- lmer(Score ~ Gaze + Audio + (1 | Participant_ID), 
           data = df)

summary(m1)

```


```{r AS}
#AS

df_on <- df %>% filter(Audio == "On")
df_off <- df %>% filter(Audio == "Off")

df %>% ggplot(aes(Gaze,Score)) + geom_point()
df %>% ggplot(aes(x = Gaze, y = Score, color = Participant_ID,  group = Participant_ID)) +
  geom_point() + geom_line() + theme_minimal() + theme(legend.position = "none")

df_on %>% ggplot(aes(Gaze,Score)) + geom_point()
df_on %>% ggplot(aes(x = Gaze, y = Score, color = Participant_ID,  group = Participant_ID)) +
  geom_point() + geom_line() + theme_minimal() + theme(legend.position = "none")

df_off %>% ggplot(aes(Gaze,Score)) + geom_point()
df_off %>% ggplot(aes(x = Gaze, y = Score, color = Participant_ID,  group = Participant_ID)) +
  geom_point() + geom_line() + theme_minimal() + theme(legend.position = "none")

df %>% ggplot(aes(Gaze,Score))+
    geom_bar(stat = 'summary',
           fun = "mean",
           width = 0.5) +
    geom_errorbar(stat = 'summary',
                fun.data = "mean_se",
                width = 0.2) +
     labs(x = "Gaze direction", 
        y = "Average credibility score (scale from 1-10)", 
        title = "Average credibility score by gaze direction") +
  theme_minimal()

```